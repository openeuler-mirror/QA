![openEuler ico](../../images/openEuler.png)

版权所有 © 2024 openEuler社区  
您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA
4.0”)的约束。为了方便用户理解，您可以通过访问<https://creativecommons.org/licenses/by-sa/4.0/>了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA
4.0的完整协议内容您可以访问如下网址获取：<https://creativecommons.org/licenses/by-sa/4.0/legalcode>。

 修订记录

| 日期 | 修订版本     | 修改描述  | 作者 |
| ---- | ----------- | -------- | ---- |
| 2024-11-13 |  1.0.0    |  初稿     | 林孟孟 |

关键词：开启IMA摘要列表+脚本类文件防护功能

摘要：IMA摘要列表 脚本类文件防护

缩略语清单：
| 缩略语 | 英文全名 | 中文解释 |
| ------ | -------- | -------- |

# 特性描述
<!-- 主要介绍特性实现的背景、功能以及作用 -->

**背景：**
安防一体机产品一般部署在地方公安局、派出所等非数据中心网络，网络防护与隔离性差，存在被植入挖矿、勒索病毒的风险。今年某视频安防厂商设备被非法入侵，挂了反D横幅，导致安防行业要求设备务必具备防非法入侵能力并加速国产化。对于安防一体机产品，本身的业务软件相对安全可控，但是存在一些非授权的执行程序入侵风险，例如挖矿病毒、勒索病毒等。需要提供完整性保护能力保证安装的软件是经过统一签名、安全可靠的。
在openEuler 24.09已交付的需求“IMA完整性保护支持用户自定义IMA校验证书场景”已支撑客户基于openEuler的IMA摘要列表特性实现自定义的摘要列表文件签名，从而实现对于可执行程序、内核模块等应用程序文件的完整性检查。
但是在客户实际运行场景中，安防一体机产品还面临着脚本类病毒的安全威胁，即攻击者通过植入恶意shell脚本、jsp脚本等进行挖矿、勒索等病毒攻击。由于这些应用程序往往以脚本文件的形式，被解释器通过read()系统调用读取并运行，该过程并不能被openEuler社区已支持的exec()等IMA策略所拦截，因此已交付的IMA摘要列表特性并不能有效为此类文件提供完整性保护检查。因此客户期望openEuler IMA摘要列表特性使能该场景的安全防护能力。

## 需求清单
|no|feature|status|sig|owner|发布方式|涉及软件包列表|
|:----|:---|:---|:--|:----|:----|:----|
|[IB3ZB1](https://gitee.com/openeuler/release-management/issues/IB3ZB1?from=project-issue)| 【openEuler 24.03-LTS-SP1 】IMA完整性保护增强，支持对解释器运行的脚本类应用程序使能完整性保护机制 | Developing | sig-security-facility | 	@zhujianwei001 | ISO  | IMA |



# 特性分层策略
## 总体测试策略
<!-- 主要描述特性的整体测试策略，主要开展哪些测试(接口/功能/场景/专项) -->

- 测试目标：验证新增接口和exec_check，ima摘要列表新增功能无异常
- 时间进度：待评估
- 风险评估：NA
- 重点事项：重点验证完整性保护功能正常，开启IMA摘要列表+脚本类文件防护功能正常
- 争议事项：NA

## 特性测试约束
<!-- 主要描述特性测试的约束条件 -->

NA


## 接口测试
<!-- 主要描述接口级测试策略及测试设计思路 -->

| 接口描述 | 设计思路 | 测试重点 | 备注 |
| ------- | ------- | ------- | ---- |
| execveat系统调用接口测试| flag入参取值为AT_CHECK，调用execveat执行脚本，脚本文件权限自定义  |检查返回值和脚本执行情况  | NA  |
| exec_check.bash启动参数测试| 增加启动参数exec_check.bash=0、1、-1\2\ab\0.1\*  |系统启动成功  | NA  |
| exec_check.java启动参数测试| 增加启动参数exec_check.java=0、1、1\2\ab\0.1\*等 |系统启动成功  | NA  |

## 功能测试
<!-- 主要描述特性提供的功能的测试策略及测试思路 -->

| 功能描述 | 设计思路 | 测试重点 | 备注 |
| ------- | ------- | ------- | ---- |
| exec_check单独使用，不开启ima| 增加启动参数exec_check.bash、java=1/0  |  检查系统启动和脚本执行    |      |
| exec_check单独使用，不开启ima| 增加启动参数exec_check.java=1、0  |  增加启动参数，不开启Java虚拟机进程加载class等文件时调用execveat功能    |      |
| exec_check和ima摘要列表一起使用  |  开启exec_check功能，IMA评估+IMA度量    |    增加启动参数，开启IMA评估以及脚本类防护功能&为允许执行的脚本文件生成IMA摘要列表，签名后导入内核&通过解释器执行脚本文件（bash test.sh \ java Test）& 修改脚本文件的权限\属主\属组\selinux\文件内容等，再通过解释器执行脚本  |  |



## 场景测试
<!-- 主要描述对特性使用的主要场景的测试策略及测试思路 -->

参考功能场景

## 专项测试
<!-- 主要描述其他专项测试,如安全测试 稳定性测试 性能测试 兼容性测试等 -->

NA

# 特性测试环境描述
<!-- 主要描述执行测试的硬件信息 -->
不涉及特殊硬件

| 硬件型号 | 硬件配置信息 | 备注 |
| -------- | ------------ | ---- |

# 特性测试执行策略

## 测试计划
<!-- 测试执行策略主要描述该轮次执行的分层策略中的测试项 -->

| Stange name   | Begin time | End time   | Days | 测试执行策略                   | 备注   |
| :------------ | :--------- | :--------- | ---- | ----------------------------- | ------ |
|     round2       |  2024/11/22        |2024/11/28       |     7|                    全量测试           |        |
|     round3- round4        |   2024/11/28         |  2024/12/12         |12      |   回归测试+长稳测试                            |        |

# 入口标准  
1.特性满足质量标准，达成需求设计要求目标

# 出口标准  
1.策略规划的测试活动涉及测试用例100%执行完毕  
2.版本无严重问题遗留，其他问题有规避措施

# 附件
