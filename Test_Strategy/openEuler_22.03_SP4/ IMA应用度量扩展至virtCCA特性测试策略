![openEuler ico](../../images/openEuler.png)

版权所有 © 2024 openEuler社区  
您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA
4.0”)的约束。为了方便用户理解，您可以通过访问<https://creativecommons.org/licenses/by-sa/4.0/>了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA
4.0的完整协议内容您可以访问如下网址获取：<https://creativecommons.org/licenses/by-sa/4.0/legalcode>。

 修订记录

| 日期 | 修订版本     | 修改描述  | 作者 |
| ---- | ----------- | -------- | ---- |
| 2024-06-15 |  1.0.0    |  初稿     | linmengmeng |

关键词：IMA度量 virtCCA

摘要：在ARM virtCCA机密虚拟机环境中开启IMA度量功能时，支持将度量结果扩展至virtCCA环境的REM0度量寄存器，并将RIM度量寄存器的值记录为boot_aggregate度量日志。 依据测试要求，对IMA支持virtCCA特性进行功能测试、可靠性测试和稳定性测试。

缩略语清单：
| 缩略语 | 英文全名 | 中文解释 |
| ------ | -------- | -------- |

# 特性描述
<!-- 主要介绍特性实现的背景、功能以及作用 -->
背景：使能virtCCA后，需要对机密虚机内的应用程序使能IMA度量。由于virtCCA本身具备可信根和远程证明机制，因此IMA支持对接virtCCA可降低部署成本，避免由于再次对接TPM造成额外的部署成本。
功能：当前版本新增功能点为：IMA支持将度量日志摘要扩展至virtCCA TMM


## 需求清单
|no|feature|status|sig|owner|发布方式|涉及软件包列表|
|:----|:---|:---|:--|:----|:----|:----|
|[I9PSTH](https://gitee.com/openeuler/release-management/issues/I9PSTH?from=project-issue)| 【openEuler-22.03 LTS SP4】openSSL支持SM4-CE指令集 | Discussion | sig-release-mana| 	@luoyukai | ISO  | IMA  |

## 风险项
<!-- 主要描述特性已知风险项 -->
测试环境依赖硬件，需提前协调

# 特性分层策略
## 总体测试策略
<!-- 主要描述特性的整体测试策略，主要开展哪些测试(接口/功能/场景/专项) -->

- 测试目标：
1、验证以下场景：无度量策略、默认度量策略、导入自定义度量策略后，确认IMA度量日志的扩展值与virtCCA REM0度量寄存器的值一致，boot_aggregate度量值与RIM度量寄存器的值与一致； 
2、反复访问被保护文件或进程，触发ima度量，确认IMA度量日志正确扩展至virtCCA TMM寄存器； 
3、反复重启系统，确认IMA度量日志正确扩展至virtCCA TMM寄存器。


- 时间进度：待评估
- 风险评估：测试环境依赖硬件，需提前协调
- 重点事项：验证度量策略和度量日志的一致性，以及日志内容的可靠性
- 争议事项：NA

## 特性测试约束
<!-- 主要描述特性测试的约束条件 -->
1.依赖920B硬件环境和virtCCA环境

## 接口测试
<!-- 主要描述接口级测试策略及测试设计思路 -->
继承用例，覆盖已有接口测试场景

## 功能测试
<!-- 主要描述特性提供的功能的测试策略及测试思路 -->
| 功能描述 | 设计思路 | 测试重点 | 备注 |
| ------- | ------- | ------- | ---- |
| 日志一致性 | 无度量策略，日志功能  | IMA度量日志的扩展值与virtCCA REM0度量寄存器的值一致，boot_aggregate度量值与RIM度量寄存器的值与一致；   |      |
| 日志一致性 | 默认度量策略，日志功能  | IMA度量日志的扩展值与virtCCA REM0度量寄存器的值一致，boot_aggregate度量值与RIM度量寄存器的值与一致；   |      |
| 日志一致性 | 导入自定义度量策略，日志功能  | IMA度量日志的扩展值与virtCCA REM0度量寄存器的值一致，boot_aggregate度量值与RIM度量寄存器的值与一致；   |    |


## 专项测试
<!-- 主要描述其他专项测试,如安全测试 稳定性测试 性能测试 兼容性测试等 -->
| 专项测试类型 | 专项测试描述 | 测试预期结果 | 备注 |
| ----------- | ----------- | ----------- | ---- |
| 可靠性测试 | 反复访问被保护文件或进程，触发ima度量  | IMA度量日志正确扩展至virtCCA TMM寄存器 |      |
| 可靠性测试 | 反复重启系统  | IMA度量日志正确扩展至virtCCA TMM寄存器 |      |


# 特性测试环境描述
<!-- 主要描述执行测试的硬件信息 -->
| 硬件型号                  | 硬件配置信息                              | 备注                   |
| ------------------------- | ----------------------------------------- | ---------------------- |
| kunpeng 920B | NA         |物理机

# 特性测试执行策略

## 测试计划
<!-- 测试执行策略主要描述该轮次执行的分层策略中的测试项 -->
| Stange name   | Begin time | End time   | Days | 测试执行策略                   | 备注   |
| :------------ | :--------- | :--------- | ---- | ----------------------------- | ------ |
|     round4          |  2024/6/12        |2024/6/19       | 7    | 全量测试                               |        |
|     round5           |   2024/6/20         |  2024/6/24        |4      |   回归测试                            |        |

# 入口标准  
1.特性满足质量标准，达成需求设计要求目标

# 出口标准  
1.策略规划的测试活动涉及测试用例100%执行完毕  
2.版本无严重问题遗留，其他问题有规避措施

# 附件
