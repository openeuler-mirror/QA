![openEuler ico](../../images/openEuler.png)

版权所有 © 2024 openEuler社区  
您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA
4.0”)的约束。为了方便用户理解，您可以通过访问<https://creativecommons.org/licenses/by-sa/4.0/>了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA
4.0的完整协议内容您可以访问如下网址获取：<https://creativecommons.org/licenses/by-sa/4.0/legalcode>。

修订记录

|  日期       |  修订版本 |  修改章节         | 修改描述                 | 作者      |
| ---------- | -------- | ---------------- | ---------------------- | --------- |
| 2024-03-19 | 1.0.0    |                  | 初稿                    | s_c_c |
| 2024-04-01 | 2.0.0    | 需求范围、测试分层策略、测试分析设计策略 | 更新需求范围   | s_c_c |
| 2024-05-06 | 3.0.0    | 测试分析设计策略、测试执行策略 | 更新测试范围   | xiongyikun |

目 录

1 概述

>   1.1 版本背景

>   1.2 需求范围

2 风险

3 测试分层策略

4 测试分析设计策略

>   4.1 新增feature测试设计策略

>   4.2 继承feature/组件测试设计策略

>   4.3 专项测试策略

5 测试执行策略

6 附件

**Keywords 关键词**：

openEuler LTS 测试策略

Abstract 摘要：

本文是openEuler 24.03 LTS embedded LLVM版本的整体测试策略，用于指导该版本后续测试活动的开展

缩略语清单：

| 缩略语 | 英文全名                             | 中文解释       |
| ------ | ------------------------------------ | -------------- |
| LTS    | Long time support                    | 长时间维护     |
| OS     | Operation System                     | 操作系统       |
| CVE    | Common Vulnerabilities and Exposures | 公共漏洞和暴露 |

# 概述

openEuler Embedded是基于openEuler社区面向嵌入式场景的Linux版本。当前openEuler内核源于Linux实现软实时能力，同时具备soc内多平面混合部署，开放基于Yocto构建包的小型化定制裁剪能力，支持openHarmony分布式软总线，同时嵌入式提供了非Linux内核的硬实时能力，是由全球开源贡献者构建的高效、稳定、安全的开源操作系统。

本文主要描述openEuler 24.03 LTS embedded LLVM版本的总体测试策略，按照社区开发模式进行运作，结合社区release-manager团队制定的版本计划规划相应的测试活动。整体测试策略覆盖新需求、继承需求的测试分析和执行，明确各个测试周期的测试策略及出入口标准，指导后续测试活动。

## 版本背景

LLVM凭借先进架构、繁荣社区和友好License成为编译器新的选择，23年3月份，软件所OERV团队和华为毕昇编译器团队在RISCV SIG和Compiler SIG联合发起“[LLVM平行宇宙计划](https://gitee.com/openeuler/TC/blob/master/oEEP/oEEP-0003%20LLVM%E5%B9%B3%E8%A1%8C%E5%AE%87%E5%AE%99%E8%AE%A1%E5%88%92--%E5%9F%BA%E4%BA%8ELLVM%E6%8A%80%E6%9C%AF%E6%A0%88%E6%9E%84%E5%BB%BAoE%E8%BD%AF%E4%BB%B6%E5%8C%85.md)”。与此同时，Embedded SIG和Compiler SIG也合作计划发布基于LLVM工具链的openEuler嵌入式版本。

openEuler 24.03 LTS是支持6.6内核和5.10双内核的全新LTS基线版本，面向嵌入式场景，持续提供更多新特性和功能扩展，给开发者和用户带来全新的体验，服务更多的领域和更多的用户。openEuler 24.03 LTS embedded LLVM版本基于openEuler 24.03 LTS Next分支拉出，发布范围限定在以下四个标准镜像：**qemu-aarch64、qemu-aarch64-kernel-6.6、raspberrypi4-64、raspberrypi4-64-kernel-6.6**。因此涉及的相关变更与特性为：

1.  相较22.03 LTS SP3软件版本选型升级，详情请见[版本变更说明]()
2.  Linux双版本内核支持

## 需求范围

openEuler 24.03 LTS版本交付[需求列表](https://gitee.com/openeuler/release-management/blob/master/openEuler-24.03-LTS/release-plan.md)见链接；openEuler 24.03 LTS embedded版本交付[需求列表](https://gitee.com/openeuler/release-management/issues/I97DTY)见链接；openEuler 24.03 LTS embedded LLVM版本交付需求列表如下：

|no|feature|status|sig|owner|发布方式|涉及软件包列表|
|:----|:---|:---|:--|:----|:----|:----|
| [I9AQ39](https://gitee.com/openeuler/yocto-meta-openeuler/issues/I9AQ39) | 【软实时OS】Linux双版本内核支持 | Developing | sig-embedded | [@fanglinxu](https://gitee.com/fanglinxu) | 源码 |  |
| [I99Y48](https://gitee.com/openeuler/yocto-meta-openeuler/issues/I99Y48) | LLVM镜像构建支持 | Developing | sig-embedded, sig-compiler | [@eastb233](https://gitee.com/eastb233) | 源码 |  |

# 风险

| 问题类型 | 问题描述 | 问题等级 | 应对措施 | 责任人 | 状态 |
| -------- | -------- | -------- | -------- | ------ | ---- |
|          |          |          |          |        |      |

# 测试分层策略

本次LTS LLVM版本的具体测试分层策略如下：

| **需求**         | **开发主体** | **测试主体** | **测试分层策略**         |
| --------------- | ----------- | ---------- | ----------------------- |
|[I9AQ39](https://gitee.com/openeuler/yocto-meta-openeuler/issues/I9AQ39) 【软实时OS】Linux双版本内核支持 | sig-embedded | sig-embedded | 验证不同内核的镜像编译并正常启动 |
|[I99Y48](https://gitee.com/openeuler/yocto-meta-openeuler/issues/I99Y48) 【标准镜像】LLVM镜像构建支持 | sig-embedded, sig-compiler | sig-compiler | LLVM标准镜像以本测试策略进行完整测试 |

# 测试分析设计策略

## 新增feature测试设计策略

| **序号** | **Feature**             | **重点**          | **设计思路**        | **备注** |
| -------- | ----------------------- | ----------------- | ------------------ | ------- |
| [I9AQ39](https://gitee.com/openeuler/yocto-meta-openeuler/issues/I9AQ39) |【软实时OS】Linux双版本内核支持 | 镜像编译、基础功能 | 构建不同内核的镜像、测试基础用例 |  |
| [I99Y48](https://gitee.com/openeuler/yocto-meta-openeuler/issues/I99Y48) |【标准镜像】LLVM镜像构建支持 | 测试标准镜像 | LLVM标准镜像以本测试策略进行完整测试，完成所有问题回归 |

## 继承feature/组件测试设计策略

从老版本继承的功能特性的测试策略如下：

| **Feature/组件**                              | **策略**                                                         |
| --------------------------------------------- | --------------------------------------------------------------- |
| 开放基于Yocto构建包的小型化定制裁剪能力  | 继承已有测试能力，使用yocto构建出不同系统 |
| 基于社区17.0.6版本LLVM提供ARM版本交叉编译工具链  | 继承已有测试能力，使用交叉编译工具链进行测试用例编译 |
| 支持树莓派4B作为嵌入式通用硬件  | 继承已有测试能力，使用树莓派进行测试 |
| 集成鸿蒙的分布式软总线，实现openEuler设备之间的互联互通 | 继承已有测试能力，测试分布式软总线接口，以及openEuler设备间互联互通 |
| 分布式软总线生态互通互联  | 继承已有测试能力，测试分布式软总线接口，以及与openharmony设备间互联互通 |
|【特性回合】【软实时OS】协议优化，提升流式数据和文件传输效率|  继承已有测试能力，测试流数据和文件传输，对比软总线字符和字节传输性能持平，在网络情况不好的情况下更加高效 |
| 【特性回合】【软实时OS】支持树莓派蓝牙|  继承已有测试能力，启动系统后可查看到蓝牙设备，并被其他蓝牙设备发现 |
| 【特性回合】【软实时OS】支持软总线支持ble发现|  继承已有测试能力，通过编程调用蓝牙发现接口，可发现自动发现对端设备 |

## 专项测试策略

### 安全测试

openEuler作为社区开源版本，在系统整体安全上需要进行保证，以发现系统中存在的安全脆弱性与风险，为版本的安全提供切实的依据，推动产品完成安全问题整改，提高产品的安全。整体安全测试需要覆盖：

1.  linux系统安全配置/权限管理等

2.  特性涉及到的安全需求验证

3.  CVE漏洞/敏感信息/端口矩阵/交付件病毒扫描

| 测试类         | 描述                      | 具体测试内容                                                 |
| -------------- | ------------------------- | ------------------------------------------------------------ |
| 安全扫描类     | CVE扫描/敏感信息/编译选项 | 通过工具进行相应的扫描，扫描结果采用增量的方式进行分析；编译选项和敏感信息需要针对新开源特性及新增软件包进行； |
| 安全配置管理类 | Linux安全规范             | Linux安全规范包括：服务管理，账号密码管理、文件及用户权限管理、内核参数配置管理、日志管理等；需对openEuler版本进行上述安全配置测试 |

### 可靠性测试

可靠性是版本测试中需重点考虑的测试活动，在各类资源异常/抢占竞争/压力/故障等背景下，通过功能的并发、反复操作进行长时间的测试；过程中通过监控系统资源、进程运行等状态，及时发现系统/特性隐藏的问题。

可靠性的测试建议从关键特性、重要组件、新增特性的可靠性指标和系统级的可靠性进行分析和设计，已保证特性和系统在各类异常、故障及压力背景下的持续提供服务的能力。

| 测试类性     | 具体测试内容                                                 |
| ------------ | ------------------------------------------------------------ |
| 操作系统长稳 | 系统在各种压力背景下，通过构造资源类和服务类等异常，随机执行LTP、系统管理操作等测试；过程中关注系统重要进程/服务，日志等异常情况；建议稳定性测试时长7\*24 |
| 操作系统重启 | 系统连续重启100次, 查看启动日志无报错，断电重启连续10次测试，查看启动日志无报错 |

### 性能测试

性能测试是针对交付件的具体性能指标，利用工具进行各类性能指标的测试。openEuler 24.03 LTS LLVM版本是首个基于LLVM的版本，所以在操作系统基本benchmark各类指标上需要和openEuler 24.03 LTS GCC版本保持一致，性能数据波动需小于5%，包括5.10版本内核和6.x版本内核，同时也需要形成基线；特性类的性能，需要按照各个特性既定的指标，进行时间效率、资源消耗底噪等方面的测试验证，保证指标项与既定目标的一致。

| **指标大项** | **指标小项**                            | **指标值**              | **说明**                          |
|--------------|----------------------------------------|-------------------------|-----------------------------------|
| OS基础性能   | 利用UnixBench进行性能测试 | 参考LTS GCC版本相应指标基线 | 与LTS GCC版本基线数据差异小于5%以内可接受，测试镜像为树莓派镜像 |

### 兼容性测试

南向兼容性测试为整机适配测试。

本次LTS LLVM版本的整机兼容性适配测试会从acpi、impi、memory、系统兼容性、CPU特性、kabi规范性、稳定性等方面进行适配，适配完成后将在社区发布本次LTS LLVM版本的整机兼容性清单。

整机适配兼容性测试交付清单如下：

| **嵌入式硬件**  | **CPU型号**  | **测试主体** | **测试计划** |
|--|--|--|--|
| 树莓派4B | BCM2711 | sig-compiler | 仅用于嵌入式linux测试和边缘版本测试 |

### 资料测试

资料测试主要是对版本交付的资料进行测试，重点是保证各个资料描述说明的清晰性和功能的正确性。资料交付清单如下：

| **手册名称**       | **覆盖策略**                                | **中英文测试策略** |
|------------------|--------------------------------------------|------------------|
| openEuler Embedded LLVM版本关键特性 | 特性介绍正确 | -   |

# 测试执行策略

openEuler 24.03 LTS LLVM版本按照社区release-manger团队既定的版本计划，共有3轮测试，按照社区研发模式，所有的需求都在拉分支前已完成合入，因此版本测试采取2+1的测试方式，即2轮全量保障本次版本发布所有特性(新增&继承)以及系统其他dfx能力，1轮回归。

### 测试计划

openEuler 24.03 LTS LLVM版本按照社区开发模式进行运作，结合社区release-manager团队制定的版本计划规划相应的测试活动。

|Stage name|Begin time|End time|Days|Note|
|:----------|:---------|:-------|:---------|:-------|
| Alpha   | 2024/4/7 | 2024/4/23 | 16    | 软件包升级，拉LTS分支，CI构建流水线搭建 |
| Test round 1           | 2024/5/9 | 2024/5/16 | 7    | 全量SIT验证|
| Test round 2           | 2024/5/17 | 2024/5/24 | 7    | 全量SIT验证   |
| Test round 3           | 2024/5/25 | 2024/5/29 | 4    | 回归测试   |
| Release                | 2024/5/30 | 2024/5/30 | 1    | 社区Release版本发布评审|

### 测试重点

测试阶段1(Alpha)：

1.  开发自验证，保证编译正常、软件功能可用

测试阶段2(Test round 1)：

1.  继承特性/新特性全量测试验证

2.  系统集成方面保证多组件多模块集成的正确性和整体系统的完整性

3.  专项：安全CVE扫描、编译选项、安全加固、敏感词扫描、端口扫描、性能、可靠性、文档测试、南北向兼容性测试

测试阶段3(Test round 2)：

1. 继承特性/新特性全量测试验证

2. 问题单回归

3. 系统集成方面保证多组件多模块集成的正确性和整体系统的完整性

4. 专项：交付件病毒扫描、南北向兼容性测试、性能、文档测试

测试阶段4(Test round 3)：

1. 交付特性/组件的自动化全量测试

2. 系统集成自动化测试项执行

3. 问题单全量回归

4. 专项：交付件病毒扫描、文档测试

### 入口标准

1.  上个阶段无block问题遗留

2.  转测版本的冒烟无阻塞性问题

### 出口标准

1.  策略规划的测试活动涉及测试用例100%执行完毕

2.  发布特性/新需求/性能基线等满足版本规划目标

3.  版本无block问题遗留，其它严重问题要有相应规避措施或说明

# 附件

无