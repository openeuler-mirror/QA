![avatar](../../images/openEuler.png)


版权所有 © 2023  openEuler社区
 您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问https://creativecommons.org/licenses/by-sa/4.0/ 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：https://creativecommons.org/licenses/by-sa/4.0/legalcode。

修订记录

| 日期 | 修订   版本 | 修改描述 | 作者 |
| ---- | ----------- | -------- | ---- |
|  2024/12/10    |      1.0.0       |     初始测试报告     |   lijindong   |
|      |             |          |      |

关键词： libkperf



摘要： 按照测试要求，针对 openEuler-24.03-LTS SP1 和 openEuler 22.03 LTS SP4 测试 libkperf 的编译、主要接口功能进行测试。测试结果良好，基本支持 libkperf 主要功能的正常使用。

缩略语清单：

| 缩略语 | 英文全名 | 中文解释 |
| ------ | -------- | -------- |
|    libkperf    |   libkperf       |   pmu采集库       |
|    libsym    |   libsym       |    符号解析库      |

# 1     特性概述

libkperf是一个轻量级linux性能采集库，它能够让开发者以API的方式执行性能采集，包括pmu采样和符号解析。libkperf把采集数据内存化，使开发者能够在内存中直接处理采集数据，避免了读写perf.data带来的开销。

# 2     特性测试信息

本节描述被测对象的版本信息和测试的时间及测试轮次，包括依赖的硬件。

| 版本名称 | 测试起始时间 | 测试结束时间 | 测试论次
| -------- | ------------ | ------------ | ---------------|
|   openEuler 24.03 LTS SP1      |     2024-11-20         |     2024-12-10         | 1                      |                    
|   openEuler 22.03 LTS SP4      |     2024-11-20         |     2024-12-10         | 1                       |

描述特性测试的硬件环境信息

| 硬件型号 | 硬件配置信息 | 备注 |
| -------- | ------------ | ---- |
| aarch64  | CPU 型号：Kunpeng 920<br />CPU 核数：128<br />内存：128G <br />磁盘：1T |
|          |              |      |

# 3     测试结论概述

## 3.1   测试整体结论

libkperf 在 openEuler-24.03-LTS SP1 和 openEuler 22.03 LTS SP4  版本测试阶段完成了功能测试，包括pmu counting计数模式、sampling采样模式、spe访存模式。整体核心功能稳定正常；完成了 aarch64 架构 （Kunpeng 920）的兼容性测试；完成了可靠性测试，可长时间稳定运行;完成了准确性测试，可和perf采集的数据进行精确对比。

## 3.2   约束说明

特性使用时涉及到的约束及限制条件

## 3.3   遗留问题分析

### 3.3.1 遗留问题影响以及规避措施

NA

### 3.3.2 问题统计

NA

# 4 详细测试结论

## 4.1 功能测试
*开源软件：主要关注开源软件升级后的变动点，继承特性由开源软件自带用例保证（需额外关注软件包提供可执行命令、库、服务功能）*
*社区孵化软件：主要参考以下列表*

### 4.1.1 继承特性测试结论

| 序号 | 组件/特性名称 | 特性质量评估 | 备注 |
| --- | ----------- | :--------: | --- |
| 1 | libsym符号解析 | <font color=green>■</font> |   |
| 2 | libkperf couting采集 | <font color=green>■</font> |   |
| 3 | libkperf sampling采集 | <font color=green>■</font> |   |
| 4 | libkperf spe采集 | <font color=green>■</font> |   |
| 5 | libkperf支持拆分子线程 | <font color=green>■</font> |   |
| 6 | libkperf支持事件分组 | <font color=green>■</font> |   |
| 7 | libkperf支持tracepointer事件 | <font color=green>■</font> |   |

### 4.1.2 新增特性测试结论

NA

## 4.2 兼容性测试结论

| 序号 | 型号                           | 遗留问题单 | 特性测试评估               | 备注                                                         |
| ---- | ------------------------------ | ---------- | -------------------------- | ------------------------------------------------------------ |
| 1    | Kunpeng 920                    | 暂无       | 测试通过 | 在不同openEuler不同版本上进行过测试，有良好的兼容性。 |


## 4.3 DFX专项测试结论

### 4.3.1 性能测试结论

libsym dwarf解析mysql百符号5s以内
libkperf采集mysql数据10s（不包含dwarf）采集+分析耗时15.3s

### 4.3.2 可靠性/韧性测试结论

可靠性主要从基础功能测试和操作响应测试方面进行测试。

支持此结论的规模是：

- arm：Kunpeng-920

| 序号 | 特性名称     | 约束依赖说明 | 遗留问题单 | 特性测试评估               | 备注                                                         |
| ---- | ------------ | ------------ | ---------- | -------------------------- | ------------------------------------------------------------ |
| 1    | 基础功能测试 | 暂无         | 暂无       | 测试通过 | 基础功能良好，接口使用方便。                         |

### 4.3.3 安全测试结论

NA

## 4.4 资料测试结论

资料内容详细无误，可有效引导开发者正确使用对应接口。

## 4.5 其他测试结论

NA

# 5     测试执行

## 5.1   测试执行统计数据

| 版本名称 | 测试用例数 | 用例执行结果 | 发现问题单数 |
| -------- | ---------- | ------------ | ------------ |
|    openEuler 24.03 LTS SP1     |    76        |      PASS        |       5       |
|    openEuler 22.03 LTS SP4     |    76        |      PASS        |       5       |

## 5.2   后续测试建议

NA

# 6     附件

*此处可粘贴各类专项测试数据或报告*

 



 

 