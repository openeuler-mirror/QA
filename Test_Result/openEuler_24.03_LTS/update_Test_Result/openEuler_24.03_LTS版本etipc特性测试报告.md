![avatar](../../images/openEuler.png)


版权所有 © 2023  openEuler社区
 您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问https://creativecommons.org/licenses/by-sa/4.0/ 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：https://creativecommons.org/licenses/by-sa/4.0/legalcode。

修订记录

| 日期 | 修订   版本 | 修改描述 | 作者 |
| ---- | ----------- | -------- | ---- |
| 2024-09-13  |  1.0 | 创建  | chengjunjia  |

关键词： 
etipc(enhanced tipc)

摘要：
本报告主要描述基于openEuler 24.03 LTS 版本进行的etipc软件包的基础测试，报告对测试情况进行说明，对特性的测试充分度进行评估和总结。

缩略语清单：

| 缩略语 | 英文全名 | 中文解释 |
| ------ | -------- | -------- |
| tipc   | transparent inter process communication | 透明进程间通信 |
| etipc  |  enhanced tipc |  增强版tipc     |

# 1     特性概述

[tipc](https://docs.kernel.org/networking/tipc.html)，作为Linux的一个内核模块，提供链路节点自动发现、多设备结点间通信功能，常用于嵌入式物理网络设备间互联，其他场景也可以使用。

当前已经针对TIPC-1.7.7版本经过大量的软件功能增强，并经过非常严格的商用验证，目前已经可以匹配Linux kernel 5.10版本，同时匹配Linux kernel 6.6版本。
Linux内核自带的tipc版本为2.0.0，
增强部分如下：
1、链路快速感知，针对原有TIPC完成随包检测感知链路健康程度，规格提升一个等级。
2、可靠组播，使能新型协议，完成可靠性组播传输能力。
3、TIPC自身的可维护性进行了大量的增加，可靠性
4、大量的链路层新特性开发，但是维持了对外的TIPC原有接口。

# 2     特性测试信息

本节描述被测对象的版本信息和测试的时间及测试轮次，包括依赖的硬件。

| 版本名称 | 测试起始时间 | 测试结束时间 |
| -------- | ------------ | ------------ |
| 1.7.7-1  | 2024-09-12  |  2024-09-13  |


描述特性测试的硬件环境信息

| 硬件型号 | 硬件配置信息 | 备注 |
| -------- | ------------ | ---- |
| 华为RH2288H V2服务器 | 56C 128GB |      |

# 3     测试结论概述

## 3.1   测试整体结论

etipc特性, 共计执行29个用例，主要覆盖单播、广播、订阅的功能测试，DFX测试和性能测试，无遗留风险，整体质量良好。


| 测试活动 | 测试子项 | 活动评价 |
| ------- | -------- | ------- |
| 功能测试 | 继承特性测试 | ptts测试用例集15个, 全部通过 |
| 功能测试 | 新增特性测试 | 增加msend、usend用例测试2个，通过 |
| 兼容性测试 |          | ptts测试用例集15个, 全部通过 |
| DFX专项测试 | 性能测试 |  时延和吞吐的测试结果如4.3.1的表所示  |
| 资料测试 |   不涉及    |  对外接口继承tipc接口 |

## 3.2   约束说明

特性使用时涉及到的约束及限制条件

## 3.3   遗留问题分析

无

# 4 详细测试结论

## 4.1 功能测试

用例编号	测试用例	预期结果

1	rpm在线编译	根据配置spec编译出要求的内核模块ko和测试用可执行文件
2	rpm解压	解压rpm包，得到tipc.ko、usend/msend/recv/tipc_config二进制文件
3	ko插入内核	可顺利插入，信息一致
4	单播测试	执行./recv后另起shell执行./usend，正常输出结果
5	多播测试	执行./recv后另起shell执行./msend，正常输出结果
6	tipc_config可显示DFX信息	tipc_config可输出显示
7	去除tipc.ko，单播、多播、tipc_config都无法运行	tipc_config回显错误，用例二进制coredump
8	tipc_utils中benchmark运行	小msg的RTT在20us以内，大msg在100us以内
9	tipc_utils中connnection_demo做连接测试	前2个连接正常，cli主动退出时server跟随退出
10	stream通信	stream通信正常
11	multicast通信	通信正常
12	记录tipc命令执行时的变动	dmesg回显tipc操作日志
13	Hello World互相通信	发送和接收的数据显示一致
14	topo订阅	server加入和退出时，client侧存在显示
15-29	ptts测试用例集	通过相关测试


## 4.3 DFX专项测试结论

### 4.3.1 性能测试结论

Transferring 80000 messages in TIPC Latency Benchmark
Client 1 created with importance MEDIUM
+---------------------------------------------------------------------+
| Msg Size [octets] |   # Msgs   | Elapsed [ms] | Avg round-trip [us] |
+---------------------------------------------------------------------+
|               64  |     80000  |         964  |              12.12  |
+---------------------------------------------------------------------+
|              256  |     40000  |         504  |              12.12  |
+---------------------------------------------------------------------+
|             1024  |     26666  |         357  |              13.13  |
+---------------------------------------------------------------------+
|             4096  |     20000  |         316  |              15.15  |
+---------------------------------------------------------------------+
|            16384  |     16000  |         414  |              25.25  |
+---------------------------------------------------------------------+
|            65536  |     13333  |         837  |              62.62  |
+---------------------------------------------------------------------+
Completed Latency Benchmark

Transferring 640000 messages in TIPC Throughput Benchmark
+---------------------------------------------------------------------------------------------+
|  Msg Size  | #     |  # Msgs/  |  Elapsed  |                    Throughput                  |
|  [octets]  | Conns |    Conn   |  [ms]     +------------------------------------------------+
|            |       |           |           | Total [Msg/s] | Total [Mb/s] | Per Conn [Mb/s] |
+---------------------------------------------------------------------------------------------+
|        64  |    1  |   640000  |     1572  |       407020  |         208  |            208  |
+---------------------------------------------------------------------------------------------+
|       256  |    1  |   320000  |      811  |       394304  |         807  |            807  |
+---------------------------------------------------------------------------------------------+
|      1024  |    1  |   160000  |      420  |       380837  |        3119  |           3119  |
+---------------------------------------------------------------------------------------------+
|      4096  |    1  |    80000  |      243  |       329109  |       10784  |          10784  |
+---------------------------------------------------------------------------------------------+
|     16384  |    1  |    40000  |      262  |       152447  |       19981  |          19981  |
+---------------------------------------------------------------------------------------------+
|     65536  |    1  |    20000  |      360  |        55423  |       29057  |          29057  |
+---------------------------------------------------------------------------------------------+


# 5     测试执行

## 5.1   测试执行统计数据

*本节内容根据测试用例及实际执行情况进行特性整体测试的统计，可根据第二章的测试轮次分开进行统计说明。*

| 版本名称 | 测试用例数 | 用例执行结果 | 发现问题单数 |
| -------- | ---------- | ------------ | ------------ |
| 1.7.7    |  29      |   All pass     |  0           |

## 5.2   后续测试建议

后续测试需要关注点(可选)

# 6     附件

*此处可粘贴各类专项测试数据或报告*
