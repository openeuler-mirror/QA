![avatar](../../images/openEuler.png)


版权所有 © 2024  openEuler社区
 您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问https://creativecommons.org/licenses/by-sa/4.0/ 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：https://creativecommons.org/licenses/by-sa/4.0/legalcode。

修订记录

| 日期 | 修订   版本 | 修改描述 | 作者 |
| ---- | ----------- | -------- | ---- |
|  2024-12-10    |  v1.0           |  初稿      |  leijie    |


关键词：AI训练  慢节点/慢卡检测

摘要：实时在线观测系统指标，定位AI集群中发生性能劣化的慢节点/慢卡


缩略语清单：

| 缩略语 | 英文全名 | 中文解释 |
| ------ | -------- | -------- |
|        |          |          |

# 1     特性概述

   AI集群在训练过程中性能劣化场景主要是复杂故障场景，导致性能劣化的原因很多且复杂，劣化感知以及快速初因定界。当前集群尚无在线劣化感知，初因定界以及根因诊断功能。本特性通过AI训练场景的慢节点/慢卡，能实时在线观测系统关键KPI，并基于模型和数据驱动的算法对观测数据进行实时分析，给出慢节点位置，便于系统自愈或者运维人员修复问题。

# 2     特性测试信息

本节描述被测对象的版本信息和测试的时间及测试轮次，包括依赖的硬件。

| 版本名称 | 测试起始时间 | 测试结束时间 |
| -------- | ------------ | ------------ |
|  openEuler-22.03-SP4   RC1   |     2024-11-19           |     2024-11-21        |
|  openEuler-22.03-SP4   RC2  |     2024-11-12           |     2024-11-28       |


描述特性测试的硬件环境信息

| 硬件型号 | 硬件配置信息 | 备注 |
| -------- | ------------ | ---- |
|    Atlas_d801/d802     |              |  NPU训练卡    |


# 3     测试结论概述

## 3.1   测试整体结论

  Gala-anteater支持AI训练场景的慢节点/慢卡检测特性，共计执行6个用例，主要覆盖了功能测试和可靠性测试，通过经过7*24的长稳测试，发现问题已解决，回归通过，无遗留风险，整体质量良好。

| 测试活动 | 测试子项 | 活动评价 |
| ------- | -------- | ------- |
| 功能测试 | 新增特性测试 | 发现问题已解决，回归通过，无遗留风险   |
| DFX专项测试 | 可靠性测试 | 未发现问题，无遗留风险|
| 资料测试 |   资料说明      |  检视意见已解决，无遗留风险       |

## 3.2   约束说明

仅针对NPU设备

## 3.3   遗留问题分析

无遗留问题

### 3.3.2 问题统计

|        | 问题总数 | 严重 | 主要 | 次要 | 不重要 |
| ------ | -------- | ---- | ---- | ---- | ------ |
| 数目   |     1     |  0    |   0   |  1    |   0     |
| 百分比 |     100%     |   0   |  0    | 100%     |   0     |

# 4 详细测试结论

## 4.1 功能测试

### 4.1.1 继承特性测试结论

无继承特性

### 4.1.2 新增特性测试结论

覆盖NPU配置多组，多起故障同时发生时，慢节点/慢卡检测的功能场景测试：

单组单次故障检测、单组多次故障检测、多组单次故障检测、多组多次故障检测

| 序号 | 组件/特性名称 | 特性质量评估 | 备注 |
| --- | ----------- | :--------: | --- |
|1 |单组8卡单次故障检测 | <font color=green>■</font> |   |
|2 |单组8卡两次故障检测 | <font color=green>■</font> |   |
|3 | 两组4卡单次故障检测| <font color=green>■</font> |   |
|4 | 两组4卡两次故障检测| <font color=green>■</font> |   |

## 4.2 兼容性测试结论

NA

## 4.3 DFX专项测试结论

### 4.3.1 性能测试结论

NA

### 4.3.2 可靠性/韧性测试结论

要求故障检测准确率大于80%及平稳运行时服务的误报率在0.5%以下：

测试结果：100次故障检测准确率：100%；72小时平稳运行误报率：0.17%，满足要求。

| 测试类型 | 测试内容 | 测试结论 |
| ------- | ------- | -------- |
|  可靠性测试       |  故障检测准确率       |  通过        |
|  可靠性测试       |  平稳运行误报率       |  通过        |

### 4.3.3 安全测试结论

NA

## 4.4 资料测试结论

| 测试类型 | 测试内容 | 测试结论 |
| ------- | ------- | -------- |
|  资料测试       |  特性资料说明       |   通过       |

https://gitee.com/openeuler/docs/pulls/14285

## 4.5 其他测试结论

NA

# 5     测试执行

## 5.1   测试执行统计数据


| 版本名称 | 测试用例数 | 用例执行结果 | 发现问题单数 | 对应issue | 
| -------- | ---------- | ------------ | ------------ | ---- |
|  openEuler-22.03-SP4   RC1       |     4       |     3 pass + 1 fail         |      1        | https://gitee.com/src-openeuler/gala-anteater/issues/IB63NS |
|  openEuler-22.03-SP4   RC2      |    6        |    6 pass          |       0       |  |

 # 6 测试说明
   
   本次仅验证arm架构软件包