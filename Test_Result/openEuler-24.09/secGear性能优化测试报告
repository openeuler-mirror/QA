修订记录

| 日期      | 修订   版本 | 修改描述                | 作者   |
| --------- | ----------- | ----------------------- | ------ |
| 2024/9/12 | v1.0        | secGear性能优化特性测试报告 | 杜晓 |

关键词：通过openSession注册共享内存、 绑核

摘要：secGear性能优化特性，新增通过openSession注册共享内存机制，并对新老版本注册共享内存做兼容。新增绑核cpu_set_t配置字段。依据测试要求对secGear性能优化特性进行功能测试。

# 1     特性概述
TEEOS版本由iTrusteeOS升级到CCOS后，新增通过openSession注册共享内存机制，共享内存一直有效，直到通过closeSession解注册共享内存。同时，switchless机制支持配置TA线程绑核，降低频繁调度切换开销，来优化REE和TEE业务线程性能。

当前版本新增功能点为：
1、支持通过openSession注册共享内存，并对新老版本注册共享内存做兼容，默认使用openSession方式。当TEEOS不支持openSession注册共享内存时，使用ecall方式注册共享内存。
2、switchless配置新增绑核cpu_set_t配置字段，支持TA线程配置绑核参数，将配置通过共享内存传入TA侧，并在switchless初始化TA线程池时，按照配置参数设置绑核。

# 2     特性测试信息

本节描述被测对象的版本信息、测试轮次和时间，以及测试使用的硬件信息。

| 版本名称                 | 测试起始时间 | 测试结束时间 |
| ----------------------  | -----------| ---------- |
| openEuler 24.09 LTS RC2 | 2024-08-22 | 2024-08-26 |
| openEuler 24.09 LTS RC3 | 2024-08-29 | 2024-09-04 |
| openEuler-24.09 LTS RC4 | 2024-09-05 | 2024-09-11 |

描述特性测试的硬件环境信息

| 硬件型号 |硬件配置信息 |备注  |
| ------- | -------- | --- |
| TaiShan 2280 V2 | Kunpeng-920-6426[Kunpeng-920-lcores:128-threads:1-nodes:4|    物理机 |

# 3     测试结论概述

## 3.1   测试整体结论

secGear性能优化特性，新增用例10个，继承用例31个，共执行用例41个，覆盖以下测试点：
1、支持通过openSession注册共享内存，并对新老版本注册共享内存做兼容，默认使用openSession方式。
2、当TEEOS不支持openSession注册共享内存时，使用ecall方式注册共享内存。
3、switchless配置绑核cpu_set_t字段，支持TA线程配置绑核参数，将配置通过共享内存传入TA侧，加解密、生成随机数等业务流程正常。
4、进行资料测试，对《安装secGear.md》、《 认识secGear.md》进行测试。
经过了测试，发现2个问题，已解决，整体质量良好。

## 3.2   约束说明

1.依赖鲲鹏920物理机

## 3.3   遗留问题分析

### 3.3.1 遗留问题影响以及规避措施

无遗留问题

### 3.3.2 问题统计

| 问题总数 | 严重 | 主要 | 次要 | 不重要 |
|---------|-----|-----|------|------ |
| 数目    | 0    | 0   |  2  | 0 |
| 百分比  | 0%   | 0%  |  100% | 0% |

问题列表如下：
https://gitee.com/src-openeuler/secGear/issues/IAPSPZ?from=project-issue
资料问题单：
https://gitee.com/src-openeuler/secGear/issues/IAQT8E?from=project-issue

# 4     测试执行

## 4.1   测试执行统计数据


| 版本名称  | 测试用例数 | 用例执行结果 | 发现问题单数 |
| -------- | -------- | ---------- | ---------- |
| openEuler 24.09 LTS RC2 |  41  |  失败1个  | 1 |
| openEuler 24.09 LTS RC3 |  41  |  均成功   | 0 |
| openEuler 24.09 LTS RC4 |  41  |  均成功   | 0 |