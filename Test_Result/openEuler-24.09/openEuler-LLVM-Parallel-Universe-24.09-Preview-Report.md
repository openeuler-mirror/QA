![openEuler ico](https://gitee.com/openeuler/QA/raw/master/images/openEuler.png)

版权所有 © 2024 openEuler社区
您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问[*https://creativecommons.org/licenses/by-sa/4.0/*](https://creativecommons.org/licenses/by-sa/4.0/) 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：[*https://creativecommons.org/licenses/by-sa/4.0/legalcode*](https://creativecommons.org/licenses/by-sa/4.0/legalcode)。

修订记录

| 日期       | 修订版本 | 修改描述                                            | 作者    |
| :--------- | :------- | :-------------------------------------------------- | :------ |
| 2024/09/18 | 1.0.0    | LLVM 平行宇宙计划 24.09 RISC-V Preview 版本测试报告 | Jean Wu |
|            |          |                                                     |         |

关键词：

openEuler LLVM Parallel Universe Project, Preview, RISC-V

摘要：

文本主要描述 openEuler LLVM 平行宇宙计划 24.09 RISC-V Preview 版本的整体测试过程，详细叙述测试覆盖情况，并通过问题分析对版本整体质量进行评估和总结。

# 1 概述

openEuler 是一款开源操作系统。当前 openEuler 内核源于 Linux，支持鲲鹏、RISC-V 及其它多种架构处理器，能够充分释放计算芯片的潜能，是面向全球开源贡献者构建的高效、稳定、安全的开源操作系统，适用于数据库、大数据、云计算、人工智能等应用场景。

openEuler LLVM 平行宇宙计划探索采用 LLVM 编译器套件替换 GCC 套件构建发行版及其组成软件包。

本文主要描述 openEuler LLVM 平行宇宙计划 24.09 RISC-V Preview 版本的总体测试活动。其按照社区开发模式进行运作，测试报告覆盖功能，性能等测试执行情况和评估，并结合各类专项测试活动和版本问题单总体情况进行整体的说明和质量评估。

# 2 测试版本说明

openEuler LLVM 平行宇宙 24.09 RISC-V 是基于 6.6 内核的版本，为 openEuler LLVM 平行宇宙计划第 2 个版本，以 Preview 预览版的形式发布。

## 2.1 版本测试计划

openEuler LLVM 平行宇宙计划 24.09 RISC-V 版本共规划 2 轮测试，详细的版本信息和测试时间如下表：

| 测试阶段     | 起始时间  | 结束时间  | Days | Note         |
| :----------- | :-------- | :-------- | :--- | :----------- |
| Test round 1 | 2024/9/2 | 2024/9/8 | 7   | 版本启动测试 |
| Test round 2 | 2024/9/9 | 2024/9/15 | 7    | 版本回归测试   |
| Release      | 2024/9/30 | 2024/9/30 | 1    |              |

## 2.2 测试环境信息

测试环境：QEMU，MILK-V Pioneer Box

MILK-V Pioneer Box 硬件信息如下

| **整机厂商** | **整机型号**       | **CPU型号** | 备注 |
| :----------- | :----------------- | :---------- | :--- |
| 算能         | MILK-V Pioneer Box | 算丰SG2042  |      |

## 2.3 需求清单

[oEEP-0003: LLVM平行宇宙计划–基于LLVM技术栈构建oE软件包
](https://www.openeuler.org/zh/oEEP/?name=oEEP-0003+LLVM平行宇宙计划--基于LLVM技术栈构建oE软件包)

## 2.4 测试活动分工

本次版本测试活动分工如下：

| **需求**                      | **开发主体**           | **测试主体**           | **测试分层策略**                                      |
| :---------------------------- | :--------------------- | :--------------------- | :---------------------------------------------------- |
| 平行宇宙计划发布 Preview 版本 | openEuler 平行宇宙计划 | openEuler 平行宇宙计划 | 验证 openEuler 平行宇宙计划产物镜像的可安装和可使用性 |

# 3 版本概要测试结论

openEuler LLVM 平行宇宙 24.09 RISC-V 版本按照既定的版本计划，共有 2 轮测试，采取 1+1 的测试方式，即 Round 1 发布的 Alpha 版本可提供外部开发者基本功能及测试条件，Round 2 进行回归测试。

openEuler LLVM 平行宇宙 24.09 RISC-V 版本 mugen 测试失败用例 269 个，有效问题 0 个，无效问题 269 个，遗留问题 0 个（详见问题单统计章节）。版本整体质量良好。

# 4 版本详细测试结论

openEuler LLVM 平行宇宙计划 24.09 RISC-V 版本详细测试内容包括：

1、完成重要组件的全量功能验证，组件和特性质量较好；

2、对发布软件包通过软件包专项完成了软件包的安装卸载、升级回滚、编译、命令行、服务检查等测试，测试较充分，质量良好；

3、专项测试包括性能专项、南向兼容性测试、可靠性测试。

## 4.1 特性测试结论

### 4.1.1 新需求评价

建议以表格的形式汇总新特性测试执行情况及遗留问题单情况的评估,给出特性质量评估结论。

| **序号** | **特性名称**                             | **测试覆盖情况**                                             | **约束依赖说明** | **遗留问题单** | **质量评估** | **备注** |
| :------- | :--------------------------------------- | :----------------------------------------------------------- | :--------------- | :------------- | :----------- | :------- |
| 1        | 平行宇宙计划 - 操作系统基础底座 (BaseOS) | 通过 mugen 自动化测试对发布范围内所有软件包进行验证；使用开源测试套对内核、编译器等重要系统组件的基本功能进行验证 | NA               |     0              | █           |          |

●： 表示特性不稳定，风险高

▲： 表示特性基本可用，遗留少量问题

█： 表示特性质量良好

## 4.2 兼容性测试结论

### 4.2.1 南向兼容性

本次发布的 LLVM 平行宇宙计划 24.09 RISC-V 版本只做整机兼容性测试。

| **整机厂商** | **整机型号**       | **CPU型号** | **测试主体**           | **测试结果**                         |
| :----------- | :----------------- | :---------- | :--------------------- | :----------------------------------- |
| 算能         | MILK-V Pioneer Box | 算丰SG2042  | openEuler 平行宇宙计划 | 对比基线（社区 24.09 RISC-V 版本初步测试结果）无新增问题 |

当前 RISC-V 版本不支持的测试项目有：acpi，clock，cpufreq，dpdk，Inifiniband，kabiwhitelist，kdump，spdk，system



## 4.3 专项测试结论

### 4.3.1 可靠性测试

| 测试类型     | 测试内容                                                     | 测试结论                        |
| :----------- | :----------------------------------------------------------- | :------------------------------ |
| 操作系统长稳 | 基于 QEMU 的系统在各种压力背景下，通过构造资源类和服务类等异常，随机执行 LTP、系统管理操作等测试；过程中关注系统重要进程和服务，日志等异常情况 | 操作系统稳定运行 7\*24小时无异常 |

### 4.3.2 性能测试

| **指标大项** | **指标小项**                                                 | **指标值**                                 | **测试结论**         |
| :----------- | :----------------------------------------------------------- | :----------------------------------------- | :------------------- |
| OS基础性能   | 进程调度子系统，内存管理子系统、进程通信子系统、系统调用、锁性能、文件子系统、网络子系统。 | 参考平行宇宙 RISC-V 24.03 版本相应指标基线 | 总体正负偏差值均在 5% 以内 |

本次测试项目：stream，lmbench，unixbench
> stream 相对先前版本带宽小幅增加延迟小幅减少
>
> lmbench 相对先前版本带宽小幅提升延迟小幅降低
>
> unixbench 相对先前版本总体单核、多核均小幅提升，部分子项上下偏差较大


### 4.3.3 安全测试

此版本对安全编译选项进行了完善，具体内容与实现方式汇报情况请见安全委员会会议纪要[链接](https://etherpad.openeuler.org/p/security-committee-meetings)。

整体安全测试覆盖：

1、通过工具nmap进行端口扫描，暴露的端口正确

# 5 问题单统计

openEuler LLVM 平行宇宙计划 24.09 RISC-V 版本 mugen 自动化测试共测试了 **488** 个测试套，**2751** 个测试用例，对比基线的社区 24.09 RISC-V 版本初步测试结果，分析出问题总数 **269** 个，其中有效问题 **0** 个，无效问题 **269** 个，挂起问题数 **0** 个

|                   测试阶段                   | 问题总数 | 有效问题数 | 无效问题数 | 挂起问题数 |   备注    |
| :------------------------------------------: | :------: | :--------: | :--------: | :-------- |:--------: |
| openEuler LLVM 平行宇宙计划 24.09 RISC-V RC1 |   269    |     0     |     269    |     0     | Alpha 轮次 |
| openEuler LLVM 平行宇宙计划 24.09 RISC-V RC2 |   0   |     0      |    0    |      0     |  回归测试  |

# 6 附件

## 遗留问题列表

| 序号 | 问题单号 | 问题简述 | 问题级别 | 影响分析 | 规避措施 | 历史发现场景 |
| --- | ------- | ------ | ------- | ------- | ------- | ---------- |
|      |          |          |          |          |          |              |

## 链接

- 详细测试结果见此[链接](https://github.com/openeuler-riscv/logs/tree/main/openEuler_LLVM_RISC-V_testreport/24.09)
- 未切换使用 LLVM/Clang 构建的软件包列表见此[链接](https://github.com/openeuler-riscv/logs/blob/main/openEuler_LLVM_RISC-V_testreport/24.09/gcc_packages.list.txt)
