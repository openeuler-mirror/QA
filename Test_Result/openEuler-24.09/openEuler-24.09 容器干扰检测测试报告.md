avatar
版权所有 © 2023 openEuler社区 您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问https://creativecommons.org/licenses/by-sa/4.0/ 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：https://creativecommons.org/licenses/by-sa/4.0/legalcode。
修订记录

| 日期 | 修订   版本 | 修改描述 | 作者 |
| ---- | ----------- | -------- | ---- |
|2024-09-27|初稿|支持 容器干扰检测 测试报告|梁栋|
|      |             |          |      |
关键词：gala-gopher gala-anteater Prometheus kafka

摘要：

缩略语清单：

| 缩略语 | 英文全名 | 中文解释 |
| ------ | -------- | -------- |
|        |          |          |
|        |          |          |

# 1     特性概述

基于 ebpf 采集并周期性上报容器粒度的 SLI 指标。支持的功能有：

采集周期内CPU调度事件的时延总计和统计直方图，关注的事件包括：调度等待，主动睡眠，锁/IO引起的阻塞，调度延迟，长系统调用等;

采集周期内Memory分配事件的时延总计和统计直方图，关注的事件包括：内存回收，换页，内存规整等;

采集周期内BIO层IO操作的时延总计和统计直方图.

# 2     特性测试信息

本节描述被测对象的版本信息和测试的时间及测试轮次，包括依赖的硬件。

| 版本名称 | 测试起始时间 | 测试结束时间 |
| -------- | ------------ | ------------ |
|openEuler-24.09 RC3|2024-08-30|2024-09-05|
|openEuler-24.09 RC4|2024-09-06|2024-09-12|
|openEuler-24.09 RC5|2024-09-13|2024-09-20|

# 3     测试结论概述

## 3.1   测试整体结论

本特性，共计执行9个用例，主要覆盖了功能测试，可靠性测试，整体质量良好。

| 测试活动 | 测试子项               | 活动评价 |
| -------- | ---------------------- | -------- |
| 功能测试 | 探针启停              | pass     |
| 功能测试 | 探针与容器启动顺序      | pass     |
| 功能测试 | 验证cpu sli指标       | pass     |
| 功能测试 | 验证memory sli指标    | pass     |
| 功能测试 | 验证io sli指标        | pass     |
| 功能测试 | 容器间CPU/IO干扰场景，干扰识别准确率达90%               | pass     |
| 功能测试 | 容器间CPU/IO干扰场景，top3干扰源检测准确率达90%               | pass     |
| 可靠性测试 | 验证探针是否报活      | pass     |
| 可靠性测试 | 服务正常重启或异常退出kill，探针是否会被重新拉起       | pass     |


## 3.2   约束说明

NA

## 3.3   遗留问题分析

### 3.3.1 遗留问题影响以及规避措施

NA

### 3.3.2 问题统计

|        | 问题总数 | 严重 | 主要 | 次要 | 不重要 |
| ------ | -------- | ---- | ---- | ---- | ------ |
| 数目   |    0      | 0     |   0   |   0   |  0      |
| 百分比 |     0     |   0   |  0    |   0   |    0    |

# 4 详细测试结论

## 4.1 继承特性测试

### 4.1.1 功能测试结论

1.覆盖探针的启停，关注探针可以正常启动与停止
2.覆盖探针与容器的启动顺序，包括先启动探针后启动容器和先启动容器后启动探针，关注不同启动顺序下，探针可以成功采集数据
3.覆盖不同sli指标，包括cpu、memory和io指标的验证，关注不同指标在注入故障后有冲高
4.覆盖容器间CPU/IO干扰场景，干扰识别准确率达90%
5.覆盖容器间CPU/IO干扰场景，top3干扰源检测准确率达90%

### 4.1.2 场景测试结论
NA
###  4.1.3 可靠性测试

覆盖以下可靠性场景，关注不同场景下，探针是否会被重新拉起：
1.验证探针是否报活，杀掉探针进程，60s后探针会被重新拉起
2.启动探针后，重启gala-gopher服务或异常kill掉gala-gopher服务，探针会被重新拉起

###  4.1.4 安全测试
NA
###  4.1.5 性能测试
NA

## 4.2 新增特性测试结论

1.覆盖cpu sli指标、memory sli指标和io sli指标，关注不同指标在注入故障后有冲高
2.覆盖容器间CPU/IO干扰场景，干扰识别准确率达90%
3.覆盖容器间CPU/IO干扰场景，top3干扰源检测准确率达90%

## 4.3 资料测试结论
资料PR链接：
https://gitee.com/openeuler/docs/pulls/14042
https://gitee.com/openeuler/docs/pulls/14088

检视意见均已闭环，新增约束描述准确，新增参数规格描述完整准确，无遗留问题。

# 5     测试执行

## 5.1   测试执行统计数据


| 版本名称 | 测试用例数 | 用例执行结果 | 发现问题单数 |
| -------- | ---------- | ------------ | ------------ |
| openEuler-24.09-round-1         |     9       |      失败0个        |      0        |
