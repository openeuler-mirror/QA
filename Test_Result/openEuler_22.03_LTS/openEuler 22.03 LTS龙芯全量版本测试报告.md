![openEuler ico](../../images/openEuler.png)

版权所有 © 2022  openEuler社区
您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问[*https://creativecommons.org/licenses/by-sa/4.0/*](https://creativecommons.org/licenses/by-sa/4.0/) 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：[*https://creativecommons.org/licenses/by-sa/4.0/legalcode*](https://creativecommons.org/licenses/by-sa/4.0/legalcode)。

修订记录

| 日期       | 修订版本 | 修改章节           | 修改描述   |
| ---------- | -------- | ------------------ | ---------- |
| 2023/10/26 | 1.0.0    | 初始               | liqianwen |


关键词：

openEuler LTS  UKUI DDE xfce gnome kiran HA  kvm qemu docker

摘要：

文本主要描述openEuler 22.03-LTS龙芯全量版本的整体测试过程，详细叙述测试覆盖情况，并通过问题分析对版本整体质量进行评估和总结。

缩略语清单：

| 缩略语      | 英文全名                             | 中文解释       |
| ----------- | ------------------------------------ | -------------- |
| OS          | Operating system                     | 操作系统       |
| iSula       | iSula                                | 轻量级容器引擎 |
| Docker      | Docker                               | Docker容器引擎 |
| DDE         | Deepin Desktop Environment           | 深度桌面环境   |
| HA          | high availability                    | 高可靠性       |
| LTS         | long time support                    | 长时间维护     |
---


# 1   概述

openEuler是一款开源操作系统。当前openEuler内核源于Linux，支持鲲鹏、龙芯及其它多种处理器，能够充分释放计算芯片的潜能，是由全球开源贡献者构建的高效、稳定、安全的开源操作系统，适用于数据库、大数据、云计算、人工智能等应用场景。

本文主要描述openEuler 22.03 LTS龙芯全量版本的总体测试活动，按照龙芯版本的测试策略展开测试。测试报告覆盖新需求、继承需求的测试执行情况和评估，并结合各类专项测试活动和版本问题单总体情况进行整体的说明和质量评估。

# 2   测试版本说明

openEuler 22.03 LTS版本是基于5.10内核22年全新的LTS基线版本，该版本基于openEuler 21.09分支拉出，同时回合master与其余LTS分支修改，发布范围相较20.03LTS 、20.03 LTS SP1、20.03 LTS SP2和20.03 LTS SP3版本主要变动：

1.  内核版本升级到5.10，默认PageSize由64K变更为4K(详情请见[TC决策-20211229](https://etherpad.openeuler.org/p/TC-meetings))
2.  软件版本选型升级，详情请见[版本变更说明](https://gitee.com/openeuler/release-management/blob/master/openEuler-22.03-LTS/%E7%89%88%E6%9C%AC%E5%8F%98%E6%9B%B4%E8%AF%B4%E6%98%8E.md)
3.  删除python2
4.  修复bug和cve

openEuler 22.03 LTS 龙芯全量版本按照社区release-manager团队的计划，共规划2轮测试，详细的版本信息和测试时间如下表：

| 版本名称                 | 测试起始时间 | 测试结束时间 |
| ----------------------- | ------------ | ------------ |
| openEuler 22.03 LTS RC1 | 2023-09-19 | 2023-10-9 |
| openEuler 22.03 LTS RC2 | 2023-10-9 | 2023-10-26|

测试的硬件环境如下：

| 硬件名称 | 硬件配置信息 | 备注 |
| ----------------------------------- | ------------------------------------------------------------ | ------------------------- |
|3C5000/3C5000L-7A2000双路服务器|主板型号：Loongson-LS2C50C2<br>cpu型号：Loongson-3C5000<br>桥片：7A2000|重点测试机型|
|3C5000-7A2000双路服务器|主板型号：Loongson-LS2C50C6<br>cpu型号：Loongson-3C5000<br>桥片：7A2000||
|3C5000-7A2000四路双桥服务器|主板型号：Loongson-TC542F0<br>cpu型号：Loongson-3C5000><br>桥片：7A2000||
|3D5000-7A2000四路服务器|主板型号：Loongson-LS2C5LE<br>cpu型号：Loongson-3D5000<br>桥片：7A2000| |
|3C5000LL-7A1000服务器|主板型号：Loongson-LS2C5LE<br>cpu型号：Loongson-3C5000LL<br>桥片：7A1000|重点测试机型|

openEuler 22.03-LTS龙芯全量版本交付需求列表如下：
详见： [openEuler 22.03 LTS 龙芯版测试策略](https://gitee.com/openeuler/QA/blob/master/Test_Strategy/openEuler_22.03_LTS/openEuler%2022.03%20LTS%20%E9%BE%99%E8%8A%AF%E7%89%88%E6%B5%8B%E8%AF%95%E7%AD%96%E7%95%A5.md "openEuler 22.03 LTS 龙芯版测试策略")

本次版本测试活动分工如下：

| **需求** | **开发主体** | **测试主体** | **测试分层策略** |
| ------------------------------- | --------------------- | ----------------- | ------------------------------------------------------------ |
| 支持HA软件                | sig-Ha                |loongson         | 验证HA软件的安装和软件的基本功能，重点关注服务的可靠性和性能等指标 |
| 支持Kiran桌面                   | sig-KIRAN-DESKTOP     | loongson | 验证kiran桌面在openEuler版本上的可安装卸载和基本功能 |
| 支持xfce桌面                    | sig-xfce              |loongson         | 验证xfce桌面系统在openEuler版本上的可安装和基本功能          |
| 支持GNOME                 | sig-gnome             | loongson      | 验证gnome桌面系统在openEuler版本上的可安装和基本功能         |
| 支持etmem内存分级扩展框架      | sig-Storage           | loongson          | 验证新发布模块memRouter内存策略框架的基本功能以及用户态页面切换技术userswap的内存迁移能力 |
| 支持定制裁剪工具套件oemaker | sig-OS-Builder | loongson  | 继承已有测试能力，验证可定制化的能力 |


# 3 版本概要测试结论

   openEuler 22.03 LTS 龙芯全量版本整体测试按照release-manager团队的计划，共完成了两轮测试，其中第一轮重点测试版本的安装启动及重点的特性和功能的全量测试，另外展开系统的性能和兼容性的测试，确保系统在功能、性能、重要特性等重点模块的健壮性和可行性；第二轮测试重点在回归验证问题，进行系统版本发布的验收测试，保证系统在发布前无阻塞性的bug。

​    openEuler 22.03 LTS 龙芯全量版本共发现问题 67 个，有效问题 53 个，遗留问题 6 个(详见遗留问题章节)，其他问题均已修复，回归测试结果正常。版本整体质量较好。

# 4 版本详细测试结论

openEuler 22.03 LTS龙芯全量版本详细测试内容包括：

1、完成重要组件包括内核、容器、虚拟化、编译器和从创新版本回合特性包括容器OS、内存分级扩展等特性的全量功能验证，组件和特性质量较好；

2、对发布软件包通过软件包专项完成了软件包的安装卸载、编译、命令行、服务检查等测试，测试较充分，质量良好；

3、系统集成测试覆盖系统配置、文件系统、服务和用户管理及网络、存储等多个方面，系统整体集成验证无风险；

4、专项测试包括性能专项、兼容性测试、可靠性测试；

## 4.1   特性测试结论

### 4.1.1   继承特性评价

对产品所有继承特性进行评价，用表格形式评价，包括特性列表（与特性清单保持一致），验证质量评估

| 序号 | 组件/特性名称 | 特性质量评估 | 备注 |
| ---- | ----------------------------------------- | :-------------------------: | ---------------------------------------------------------------------------------------------------------------------- |
| 1 | 内核 | <font color=green>█</font> | 继承内核已有测试能力，通过使用开源测试套LTP和mmtest对内核开展基本功能进行测试；并通过构建地址消毒的内核版本利用syzkaller开源测试套进行fuzz测试；通过构建系统压力，反复长时间随机执行LTP基本系统调用，对内核开展7*24小时的稳定性测试，整体用例执行通过；内核整体质量良好 |
| 2 | 容器(isula/docker/镜像)| <font color=green>█</font> | 覆盖容器领域iSula和docker引擎的基本能力，针对普通容器和容器镜像进行基础功能测试，用例执行全部通过，整体质量良好 |
| 3 | 编译器(gcc/jdk) | <font color=green>█</font> | 对gcc/jdk组件完成测试套FPTEST、csmith、yarpgen基础功能的全量覆盖，全部测试通过，编译器组件整体质量良好 |
| 4 | 虚拟化(qemu)| <font color=green>█</font> | 共在两个平台上分别执行测试，执行2×116个测试项，执行继承已有测试能力，覆盖虚拟化组件(qemu) 的基本功能、可靠性、稳定性及场景测试，使用开源的测试套tp-libvirt和tp-qemu开展各类测试，整体质量良好 |
| 5 |安装部署| <font color=green>█</font>|共在五个平台上分别执行测试，执行5×74个测试项，覆盖各个安装选择环境以及pxe、网络源等重点测项，整体安装模块质量良好，全部测试通过，整个核心功能均可正常满足| 
| 6 | 支持xfce桌面 | <font color=blue>▲</font> | 共在两个平台上分别执行测试，执行2×93个测试项，整体核心功能(重要组件和系统插件)稳定正常，发现3个问题，，3个问题遗留，整体核心功能可正常满足使用，整体质量良好 |
| 7 | 支持kiran桌面 | <font color=blue>▲</font> | 共在两个平台上分别执行测试，执行2×93个测试项，整体核心功能(重要组件和系统插件)稳定正常，发现3个问题，其中2个问题为无效问题，1个问题遗留，整体质量良好 |
| 8| 支持gnome桌面 | <font color=green>█</font>| 共在两个平台上分别执行测试，执行2×63个测试项，整体核心功能(重要组件和系统插件)稳定正常，全部测试通过，整体核心功能可正常满足，整体质量良好 |
|9| 支持HA高可用pacemaker| <font color=green>█</font> | 共在两个平台上分别执行测试，执行测试用例2×25条，主要覆盖HA的基本能力；在各类资源异常失效情况下的切换能力；日志收集功能及网络故障异常场景下的HA功能，通过长时间测试，稳定性良好，特性基本可用。 |
| 10 | 支持内存分级扩展| <font color=green>█</font> | 共在两个平台上分别执行测试，根据测试代码https://gitee.com/openeuler/mugen/pulls/1027 展开测试，测试全部通过；整体质量良好<br/>约束：1、客户端和服务端需要在同一个服务器上部署，不支持跨服务器通信的场景<br/>2、仅支持扫描进程名小于或等于15个字符长度的目标进程 |
|11 | 定制裁剪工具套件oemaker( | <font color=green>█</font> | 覆盖裁剪工具的基本命令功能，并对异常参数进行覆盖；另外对裁剪出来的镜像进行安装部署及基本验证，保障裁剪工具的E2E能力完整性 |


<font color=red>●</font>： 表示特性不稳定，风险高

<font color=blue>▲</font>： 表示特性基本可用，遗留少量问题

<font color=green>█</font>： 表示特性质量良好

## 4.2   兼容性测试结论

### 4.2.1   升级兼容性

openEuler 22.03-LTS龙芯全量版本作为5.10内核的第一个LTS版本，不涉及升级兼容性测试，后续SP版本会对应进行开展。

### 4.2.2   南向兼容性

南向兼容性继承已有的测试能力，按照release-manager团队的规划，版本发布后会进行持续的兼容性测试。通过兼容性测试套件完成了5类整机的测试(该数目仅为测试数量，实际兼容性认证通过数量见社区[兼容性清单](https://www.openeuler.org/zh/compatibility/))

下表列出版本集成验证中涉及的硬件整机信息：

| 硬件型号 | 硬件详细信息 |
| --------------------- |------------------------------------------------------------------------------------ |
|3C5000/3C5000L-7A2000双路服务器|主板型号：Loongson-LS2C50C2<br>cpu型号：Loongson-3C5000<br>桥片：7A2000|
|3C5000-7A2000双路服务器|主板型号：Loongson-LS2C50C6<br>cpu型号：Loongson-3C5000<br>桥片：7A2000|
|3C5000-7A2000四路双桥服务器|主板型号：Loongson-TC542F0<br>cpu型号：Loongson-3C5000><br>桥片：7A2000|
|3C5000LL-7A1000服务器|主板型号：Loongson-LS2C5LE<br>cpu型号：Loongson-3C5000LL<br>桥片：7A1000|
|3D5000-7A2000四路服务器|主板型号：Loongson-LS2C5LE<br>cpu型号：Loongson-3D5000<br>桥片：7A2000|

### 4.2.3   北向兼容性
虚拟机兼容性情况列表如下：

| OS版本  | 架构 |  虚拟化组件版本 |
| ------ | ---- | ------------ |
| Loongnix-Server 8.4 | loongarch64 | qemu 4.2.0<br>libvirt 6.0.0<br> virt-manager 2.2.1|
| AnolisOS 8.8 QU1 | loongarch64| qemu 6.2.0<br>libvirt 8.0.0<br> virt-manager 4.1.0|


## 4.3   专项测试结论

### 可靠性测试

| 测试类型 | 测试内容 | 测试结论 |
| ------- | ------------------------------------------------------------------------------ | -------------------------- |
| 操作系统长稳 | 系统在各种压力背景下，随机执行LTP等测试；过程中关注系统重要进程/服务、日志的运行情况； | 操作系统稳定运行7*24小时   |
| 虚拟化长稳 | 结合Avocado-vt对新增特性开展长期测试 | 虚拟化组件稳定运行7*24小时 |


### 性能测试

| **指标大项** | **指标小项** | **指标值** | **测试结论** |
| ------------- | ------------------------------------------------------------ | --------------------------------- | -------------------- |
| OS基础性能 | 进程调度子系统，内存管理子系统、进程通信子系统、系统调用、锁性能、文件子系统、网络子系统。 | 社区首个LA架构的版本，无参照的社区版本指标基线 | 性能数据结果符合预期 |

> 该版本未规划基础性能以外的性能需求，继承的性能需求(场景化性能需求/虚拟化性能需求)均纳入SP1版本继承。

# 5   问题单统计

openEuler 22.03-LTS龙芯全量版本共发现问题 67 个，有效问题 53 个，其中修复问题单 61 个，回归均通过。详细分布见下表:

| 测试阶段 | 问题总数 | 有效问题单数 | 无效问题单数 |
| ----------------------- | -------- | ----------- | ---------- |
| openEuler 22.03 LTS RC1 | 44| 34 | 10 |
| openEuler 22.03 LTS RC2 | 23 | 19 | 4 |

整体看核心镜像范围内软件问题单收敛趋势明显。在版本发布过程中，需要联合release-sig强管控特性的合入周期，

# 6   附件

## 遗留问题列表

| 序号 | 问题单号 | 问题简述 | 问题级别 | 影响分析 | 规避措施 | 历史发现场景 |
| ---- | ------- | -------- | -------- | ------- | -------- | --------- |
|1|http://bugs.loongnix.cn/show_bug.cgi?id=3649 |[DDE]安装DDE后,执行dnf install dde，缺少软件包|次要|本次支持Gnome桌面、xfce桌面、kiran桌面，DDE桌面类问题后续修复|使用Gnome桌面、xfce桌面、kiran桌面|2203 LTS新增|
|2|http://bugs.loongnix.cn/show_bug.cgi?id=3668 |[ukui]安装ukui桌面,执行dnf install ukui，软件包冲突|次要|本次支持Gnome桌面、xfce桌面、kiran桌面，ukui桌面类问题后续修复|使用Gnome桌面、xfce桌面、kiran桌面|2203 LTS新增|
|3|http://bugs.loongnix.cn/show_bug.cgi?id=3675 |[xfce]安装依赖测试失败|次要|不影响xfce桌面基本功能的使用|版本遗留，后续通过更新源解决|2203 LTS新增|
|4|http://bugs.loongnix.cn/show_bug.cgi?id=3674 |[xfce]缺少firefox包|次要|不影响xfce桌面基本功能的使用|版本遗留，后续通过更新源解决|2203 LTS新增|
|5|http://bugs.loongnix.cn/show_bug.cgi?id=3673 |[xfce]安装xfce后，登陆界面，点击休眠，无法正常休眠|次要|不影响xfce桌面基本功能的使用|版本遗留，后续修复|2203 LTS新增|
|6|http://bugs.loongnix.cn/show_bug.cgi?id=3671 |[kiran]帮助功能无法正常使用，打开桌面用户指南软件，界面无任何信息|次要|不影响kiran桌面基本功能的使用|版本遗留，后续修复|2203 LTS新增|

# 致谢
非常感谢以下开发者在openEuler 22.03 LTS版本测试中做出的贡献,以下排名不分先后
[xxx](xxxx)

