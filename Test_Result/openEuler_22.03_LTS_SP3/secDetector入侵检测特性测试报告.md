![openEuler ico](../../images/openEuler.png)

版权所有 © 2023  openEuler社区
 您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA 4.0”)的约束。为了方便用户理解，您可以通过访问https://creativecommons.org/licenses/by-sa/4.0/ 了解CC BY-SA 4.0的概要 (但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：https://creativecommons.org/licenses/by-sa/4.0/legalcode。

修订记录

| 日期           | 修订   版本 | 修改描述                        | 作者   |
| -------------- | ----------- | ------------------------------- | ------ |
| 2023年12月22日 | 初稿        | secDetector入侵检测特性测试报告 | 李佳明 |

 关键词： secDetector，入侵检测

摘要：

缩略语清单：

| 缩略语 | 英文全名 | 中文解释 |
| ------ | -------- | -------- |
|        |          |          |
|        |          |          |

# 1     特性概述

secDetector 是专为OS设计的内构入侵检测系统，旨在为关键信息基础设施提供入侵检测及响应能力，为第三方安全工具减少开发成本同时增强检测和响应能力。secDetector 基于ATT&CK攻击模式库建模提供更为丰富的安全事件原语，并且可以提供实时阻断和灵活调整的响应能力。

# 2     特性测试信息

本节描述被测对象的版本信息和测试的时间及测试轮次，包括依赖的硬件。

| 版本名称                    | 测试起始时间 | 测试结束时间 |
| --------------------------- | ------------ | ------------ |
| openEuler 22.03 LTS-SP3 RC1 | 2023-11-23   | 2023-11-29   |
| openEuler 22.03 LTS-SP3 RC2 | 2023-12-2    | 2023-12-8    |
| openEuler 22.03 LTS-SP3 RC3 | 2023-12-9    | 2023-12-15   |
| openEuler 22.03 LTS-SP3 RC4 | 2023-12-18   | 2023-12-22   |

# 3     测试结论概述

## 3.1   测试整体结论

测试secdetector入侵检测特性，共计新增25个用例，主要覆盖了：

1. 覆盖提供的sdk接口的非法取值场景
2. 覆盖文件探针的各个检测场景，包括文件创建，销毁，读写，修改各种属性等
3. 覆盖进程探针的各个检测场景，包括进程创建，销毁，执行，权限变更等
4. 覆盖行为探针的各个检测场景，包括匿名指针的创建，命令执行，特定api执行等
5. 覆盖安全开关探针，与内核模块检测探针场景，当检测项变化时验证能否上报事件
6. 覆盖各个贪占的并发检测场景，在并发攻击时检测能力正常
7. 覆盖多用户注册reader场景，并发时多用户均可正常获取事件
8. 覆盖kasan长稳测试，验证可靠性功能
9. 覆盖安全场景，进行白盒代码检视，文件权限检查，验证特性安全性

综上，所覆盖整场景表现符合预期，攻击行为无漏报，整体质量良好。

## 3.2   约束说明

1. 部分功能（如内存修改探针-安全开关）依赖硬件体系结构，因此在不同指令集架构上的表现并不相同。
2. 从内核到用户态传输数据缓存空间为探针共享，缓冲区满会丢弃新采集的事件信息。缓存空间可配置范围为4~1024 MB, 必须为2的幂。
3. 服务进程secDetectord支持root用户运行，不支持多实例，非第一个运行的程序会退出。
4. 用户订阅连接数限制为5个。
5. 用户订阅后，读取消息时需要为消息读取接口提供一块缓冲区，超过缓冲区长度的消息将被截断。建议缓冲区长度不低于4096。
6. 对于文件名、节点名之类的描述字符串都有一定的长度限制，过长可能会被截断。
7. 应用程序单进程内不支持并行多连接 secDetectord 接收消息。只能一次订阅，单连接接受消息。去订阅后才能重新订阅。
8. secDetectord 进程应当等待所有应用程序的连接中断即完全退订所有主题后，才可以关闭退出。
9. 部分功能（如内存修改探针-安全开关）基于当前CPU状态。因此检测的基本功能是可以检测到当前CPU上的状态变化，其他CPU上的状态变化如果未能及时同步到当前CPU，则不会被检测到。

## 3.3   遗留问题分析

### 3.3.1 遗留问题影响以及规避措施

| 问题单号 | 问题描述 | 问题级别 | 问题影响和规避措施 | 当前状态 |
| -------- | -------- | -------- | ------------------ | -------- |
|          |          |          |                    |          |

### 3.3.2 问题统计

|        | 问题总数 | 严重 | 主要 | 次要 | 不重要 |
| ------ | -------- | ---- | ---- | ---- | ------ |
| 数目   | 14       | 0    | 6    | 8    | 0      |
| 百分比 | 100%     | 0%   | 43%  | 57%  | 0%     |

# 4     测试执行

## 4.1   测试执行统计数据

*本节内容根据测试用例及实际执行情况进行特性整体测试的统计，可根据第二章的测试轮次分开进行统计说明。*

| 版本名称                    | 测试用例数 | 用例执行结果 | 发现问题单数 |
| --------------------------- | ---------- | ------------ | ------------ |
| openEuler 22.03 LTS-SP3 RC1 | 25         | 失败8个      | 11           |
| openEuler 22.03 LTS-SP3 RC3 | 25         | 失败2个      | 2            |
| openEuler 22.03 LTS-SP3 RC4 | 25         | 失败1个      | 1            |

*数据项说明：*

*测试用例数－－到本测试活动结束时，所有可用测试用例数；*

*发现问题单数－－本测试活动总共发现的问题单数。*
