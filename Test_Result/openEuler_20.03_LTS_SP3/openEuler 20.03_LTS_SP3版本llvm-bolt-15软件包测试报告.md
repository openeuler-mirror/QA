![openEuler ico](../../images/openEuler.png)

版权所有 © 2023 openEuler社区
您对“本文档”的复制、使用、修改及分发受知识共享(Creative Commons)署名—相同方式共享4.0国际公共许可协议(以下简称“CC BY-SA
4.0”)的约束。为了方便用户理解，您可以通过访问https://creativecommons.org/licenses/by-sa/4.0/ 了解CC BY-SA 4.0的概要 (
但不是替代)。CC BY-SA 4.0的完整协议内容您可以访问如下网址获取：https://creativecommons.org/licenses/by-sa/4.0/legalcode。

修订记录

| 日期      | 修订   版本 | 修改描述 | 作者   |
| --------- | ----------- | -------- | ------ |
| 2023.9.4 | v1.0        | 初始化   | 赵震宇 |

关键词： llvm-bolt-15测试报告

摘要：依据测试要求，对llvm-bolt-15进行自编译、安装卸载验证及测试。

缩略语清单：

| 缩略语 | 英文全名 | 中文解释 |
| ------ | -------- | -------- |
|        |          |          |
|        |          |          |



# 1     测试信息

本节描述被测对象的版本信息和测试的时间及测试轮次，包括依赖的硬件。

| 版本名称                | 测试起始时间 | 测试结束时间 |
| ----------------------- | ------------ | ------------ |
| openEuler 20.03_LTS_SP1 | 2023-9-4    | 2023-9-4    |



描述测试的硬件环境信息

| 硬件型号 | 硬件配置信息                  | 备注        |
| -------- | ----------------------------- | ----------- |
| 容器     | CPU:96core MEM:256G DISK:200G | aarch64架构 |
| 容器     | CPU:96core MEM:256G DISK:200G | x86架构     |





# 2    测试结论概述

## 2.1   测试整体结论

llvm-bolt-15，测试使用ninja测试套，在aarch64上共执行49176个测试用例，在x86上共执行49269个测试用例。未发现问题，所有测试点全部通过。

| 测试活动     | 活动评价                   |
| ------------ | -------------------------- |
| 自编译测试   | 自编译功能正常，结果如预期 |
| 安装卸载测试 | 安装卸载正常，结果如预期   |



## 2.2   遗留问题分析

### 2.2.1 遗留问题影响以及规避措施

| 问题单号 | 问题描述 | 问题级别 | 问题影响和规避措施 | 当前状态 |
| -------- | -------- | -------- | ------------------ | -------- |
|          |          |          |                    |          |
|          |          |          |                    |          |

### 2.2.2 问题统计

|        | 问题总数 | 严重 | 主要 | 次要 | 不重要 |
| ------ | -------- | ---- | ---- | ---- | ------ |
| 数目   | 0        |      |      |      |        |
| 百分比 |          |      |      |      |        |



# 3     测试执行

## 3.1   测试执行统计数据

| Name    | Unsupported | Passed | Expectedly Failed | SKIPPED | Fail | Sum  |
| ------- | ----------- | ------ | ----------------- | ------- | ---- | ---- |
| Aarch64 | 26556       | 22433  | 42                | 145     | 0    | 49176|
| X86     | 21695       | 27454  | 60                | 60      | 0    | 49269|

在 openEuler 20.03 LTS SP3版本中 需要手动 将 python-lit 升级到 python15.0.7 <br>
需要在非 root 权限下执行测试，在root权限下执行测试会产生权限问题



*数据项说明：*

*测试用例数－－到本测试活动结束时，所有可用测试用例数；*

*发现问题单数－－本测试活动总共发现的问题单数。*

*Unsupported： 经确认，不支持用例为指定后端用例。*

Failed: 经确认失败用例不影响正常使用





## 3.2   后续测试建议

后续测试需要关注点(可选)



# 4    附件

## 自编译测试报告

### 执行步骤

```
cd WORK_DIR/rpmbuild/SPECS/
dnf install rpmdevtools
rpmbuild -ba llvm-bolt.spec

cd WORK_DIR/rpmbuild/RPM/aarch64/
rpm -ivh llvm-bolt-15.0.7-1.aarch64.rpm
rpm -e llvm-bolt

```


### 执行步骤

```
cd WORK_DIR/rpmbuild/SPECS/
dnf install rpmdevtools
rpmbuild -ba llvm-bolt.spec

cd WORK_DIR/rpmbuild/RPM/noarch/
rpm -ivh llvm-bolt-15.0.7-1.noarch64.rpm
rpm -e llvm-bolt

```

### 执行结果

安装和卸载均成功，测试通过





# 软件升级差异分析


| 差异分类    | 差异项                                                | 差异说明                                                     | 影响评估                                                     |
| ----------- | ----------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 特性变化    | 新增特性/删除特性/变更特性实现                        | 无                                                           |                                                              |
|             |                                                       |                                                              |                                                              |
| 配置文件    | 新增/变更/删除配置项                                  | 无                                                           |                                                              |
|             |                                                       |                                                              |                                                              |
| ABI差异     | 新增/变更/删除API                                     | 无                                                           |                                                              |
|             | 新增/变更/删除结构体                                  | 无                                                           |                                                              |
|             |                                                       |                                                              |                                                              |
| 命令行/功能 | 新增/变更/删除命令                                    | 删除命令：<br/>                       -remove-symtab         | remove-symtab 将符号表从二进制可执行文件中删除。这个命令可以用于优化可执行文件的大小和保护代码的机密性。但是此操作可能会导致一些以调试和分析工具无法正常操作。而且 llvm-strip 可以实现相同效果。<br/>综上，在 llvm-bolt-15 中删除 remove-symtab 没有影响。 |
|             | 新增/变更/删除命令选项                                | 删除命令选项：<br/>                   - split functions=\<vlaue\> <br/>=0<br/>=1<br/>=2<br/>=3<br/> | 在 llvm-bolt 中，使用split-function，当 value为 0 时不对任何 function 进行操作，当 value 为 1 时 支只对较大 function 函数进行分区， 当 value 为 2 时效果与 1 相同，只是做了向后兼容适配，当 value 为 3 时 对所有 function 进行 分区。<br/>在 llvm-bolt-15 中，使用 split- function 没有命令选项，对所有 function 进行分区。<br/> 该命令是为了将频繁使用的function放置在紧凑的内存区域中，提高指令缓存的命中率，从而提升程序性能。理应对所有 function 进行分区。<br/> 综上，删除该命令选项影响较小。 |
|             | 新增/变更/删除日志输出                                |                                                              |                                                              |
|             |                                                       |                                                              |                                                              |
| SPEC文件    | 新增/变更/删除 编译依赖、安装依赖、依赖的软件版本变更 | 删除构建依赖：   <br/>libstdc++-static <br/>chrpath <br/>ncurses-devel<br/>glibc <br/>zlib <br/>ncurses-libs <br/>libstdc++ <br/>libgcc | 刷新依赖，没有影响。                                         |
|             | 拆分软件包方式变更                                    | 无                                                           |                                                              |

